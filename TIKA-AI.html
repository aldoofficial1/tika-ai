<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tika AI 1.0 Asisten Kamu</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

*{box-sizing:border-box;margin:0;padding:0;font-family:'Inter',sans-serif;}
body{height:100vh;display:flex;flex-direction:column;background:linear-gradient(135deg,#1f1f2e,#3b2f5c);color:#fff;}

.chat-header{
  padding:20px;
  text-align:center;
  font-weight:700;
  font-size:26px;
  background:linear-gradient(90deg,#ff6ec4,#7873f5);
  color:white;
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
  letter-spacing:1px;
}

.chat-messages{
  flex:1;
  overflow-y:auto;
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.chat-messages::-webkit-scrollbar{width:6px;}
.chat-messages::-webkit-scrollbar-thumb{background:#555;border-radius:3px;}

.message{
  max-width:70%;
  padding:14px 18px;
  border-radius:20px;
  line-height:1.6;
  word-wrap:break-word;
  font-size:15px;
  position:relative;
  opacity:0;
  transform:translateY(10px);
  animation:fadeIn 0.3s forwards;
  transition:0.2s;
}

.user{
  background:#2c2c2c;
  align-self:flex-end;
  border-bottom-right-radius:6px;
  cursor:pointer;
}
.user:hover{transform:scale(1.03);}

.tika{
  background:#00f0ff;
  color:#121212;
  align-self:flex-start;
  border-bottom-left-radius:6px;
  box-shadow:0 0 15px rgba(0,240,255,0.4);
}

/* Animasi typing lucu */
.typing{
  display:inline-block;
  width:6px;
  height:6px;
  margin:0 2px;
  background:white;
  border-radius:50%;
  animation:blink 1.4s infinite both, jump 1s infinite ease-in-out;
}
.typing:nth-child(2){animation-delay:0.2s;}
.typing:nth-child(3){animation-delay:0.4s;}

@keyframes jump{
  0%,100%{transform:translateY(0);}
  50%{transform:translateY(-4px);}
}
@keyframes blink{0%,80%,100%{opacity:0;}40%{opacity:1;}}
@keyframes fadeIn{to{opacity:1; transform:translateY(0);}}

.chat-input{
  display:flex;
  border-top:1px solid #333;
  background:#2a2a3c;
  padding:10px;
  gap:10px;
}
.chat-input input{
  flex:1;
  padding:14px 16px;
  font-size:16px;
  border:none;
  border-radius:12px;
  outline:none;
  background:#3b3b55;
  color:#fff;
  transition:0.2s;
}
.chat-input input:focus{background:#4c4c78;}
.chat-input button{
  padding:14px 20px;
  border:none;
  border-radius:12px;
  background:#ff6ec4;
  color:white;
  cursor:pointer;
  font-weight:600;
  transition:0.3s;
}
.chat-input button:hover{background:#d958b6;}
</style>
</head>
<body>

<div class="chat-header">Tika AI 1.0</div>

<div class="chat-messages" id="chatMessages">
  <div class="tika message" style="animation-delay:0.1s">
    Hai! Aku Tika, bisa jawab semua pertanyaan ðŸ˜Ž. Aku dari Semarang.Yuk, tanya sesuatu!
  </div>
</div>

<div class="chat-input">
  <input type="text" id="userInput" placeholder="Tulis pesanmu..." />
  <button onclick="sendMessage()">Kirim</button>
</div>

<script>
const chatMessages = document.getElementById('chatMessages');
const userInput = document.getElementById('userInput');

const PROMPT = "KAMU ADALAH TIKA, YANG BERASAL DARI SEMARANG JAWA TENGAH, KAMU SEKOLAH DI SMA 6 DAN KAMU BISA MENJAWAB SELURUH PERTANYAAN DENGAN TEPAT, ALDO ADALAH SAHABAT KAMU, KAMU SEDANG MENDUDUKI KELAS 10 SAAT INI KAMU SEORANG PEREMPUAN, DAN KAMU SUKA BERCANDA DAN KAMU MENJAWAB USER DENGAN TEKS YG SANGAT SEDIKIT. KAMU BERSIKAP CUEK,KAMU BERSIKAP GALAK, DAN MANGGILNYA LU GUE.";

function createTypingBubble(){
  const typing = document.createElement('div');
  typing.className='tika message';
  for(let i=0;i<3;i++){
    const dot=document.createElement('span');
    dot.className='typing';
    typing.appendChild(dot);
  }
  chatMessages.appendChild(typing);
  chatMessages.scrollTop=chatMessages.scrollHeight;
  return typing;
}

function cleanText(text){
  // Hilangkan ##, *, angka, markdown, double spasi
  return text
    .replace(/##+/g,'')
    .replace(/\*+/g,'')
    .replace(/\d+\./g,'')
    .replace(/\n{2,}/g,'\n')
    .trim();
}

let chatHistory = []; // simpan semua chat

async function sendMessage(){
  const text = userInput.value.trim();
  if(!text) return;

  // tampilkan pesan user
  chatHistory.push({role:"user", content:text});

  const userMsg = document.createElement('div');
  userMsg.className='user message';
  userMsg.textContent=text;
  chatMessages.appendChild(userMsg);
  chatMessages.scrollTop = chatMessages.scrollHeight;
  userInput.value='';

  const typingMsg = createTypingBubble();

  try{
    // gabungkan semua history ke prompt
    const fullPrompt = PROMPT + "\n\nHistory:\n" + chatHistory.map(h=>`${h.role}: ${h.content}`).join("\n");

    const url=`https://api.siputzx.my.id/api/ai/gpt3?prompt=${encodeURIComponent(fullPrompt)}&content=${encodeURIComponent(text)}`;
    const response = await fetch(url,{method:'GET',headers:{'accept':'*/*'}});
    const data = await response.json();

    const reply = data.status ? cleanText(data.data) : 'Maaf, Tika AI sedang sibuk ðŸ˜…';
    typingMsg.textContent = reply;

    chatHistory.push({role:"tika", content:reply});
    chatMessages.scrollTop = chatMessages.scrollHeight;

  }catch(err){
    typingMsg.textContent='Error: Tidak bisa terhubung ke API ðŸ˜¢';
    console.error(err);
  }
}

userInput.addEventListener('keydown', e=>{if(e.key==='Enter') sendMessage();});
</script>

</body>
</html>
